/home/currycareation/.local/lib/python3.12/site-packages/milvus_lite/__init__.py:15: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import DistributionNotFound, get_distribution

ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€
PRODUCTION-GRADE MILVUS POPULATION PIPELINE
ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€

ðŸŽ® GPU Device: NVIDIA GeForce RTX 5080
ðŸ’¾ GPU Memory: 15.46 GB

ðŸ“¦ Loading cached embeddings from: experiment_results/embedding_cache.pkl
âœ… Loaded cached embeddings (0.27 MB)

ðŸ—„ï¸  Initializing Production Milvus Database...

================================================================================
Setting up Milvus Vector Database for Production
================================================================================

âœ… Found existing Milvus database: experiment_results/milvus_retail_enhanced.db

âœ… Milvus setup complete

âœ… Connected to Milvus database: experiment_results/milvus_retail_enhanced.db
ðŸ—‘ï¸  Dropping existing collection: retail_items
ðŸ“Š Creating production collection: retail_items
âœ… Collection 'retail_items' created successfully
   Embedding dimension: 128
   Index type: FLAT
   Metric type: COSINE

ðŸ“‹ Preparing embeddings for batch insertion...

ðŸ“¥ Inserting 520 embeddings into Milvus...
   Batch size: 1000
Inserting batches:   0%|          | 0/1 [00:00<?, ?it/s]Inserting batches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 67.30it/s]
ðŸ’¾ Flushing data to disk...

âœ… Successfully inserted 520 embeddings
   Collection stats: {'row_count': 520}


================================================================================
âœ… MILVUS DATABASE POPULATION COMPLETE
================================================================================
ðŸ“Š Database: experiment_results/milvus_retail_enhanced.db
ðŸ“¦ Collection: retail_items
ðŸ”¢ Total embeddings: 520
ðŸ·ï¸  Total classes: 59
ðŸ“ˆ Collection stats: {'row_count': 520}
ðŸŽ¯ Ready for production similarity search!
================================================================================

âœ… Milvus connection closed
ðŸ§¹ GPU memory cleaned up

âœ… Using existing YOLOv8 model: grocery/runs/yolov8_grocery_baseline_20251114_194239/weights/best.pt
âœ… Using existing YOLOv11 model: grocery/runs/yolo11_grocery_baseline_20251114_1953262/weights/best.pt

================================================================================
Running Experiment: YOLOv8_Baseline_488_Classes
================================================================================

Evaluating YOLO baseline model...
Ultralytics 8.3.221 ðŸš€ Python-3.12.3 torch-2.9.0+cu128 CUDA:0 (NVIDIA GeForce RTX 5080, 15832MiB)
Model summary (fused): 92 layers, 25,873,921 parameters, 0 gradients, 78.9 GFLOPs
[34m[1mval: [0mFast image access âœ… (ping: 0.0Â±0.0 ms, read: 6590.5Â±1855.2 MB/s, size: 66.2 KB)
[K[34m[1mval: [0mScanning /home/currycareation/Desktop/yolo_embeding_malvious_repo/data/grocery_augmented/valid/labels.cache... 296 images, 77 backgrounds, 0 corrupt: 100% â”â”â”â”â”â”â”â”â”â”â”â” 296/296 124.2Mit/s 0.0s[K[34m[1mval: [0mScanning /home/currycareation/Desktop/yolo_embeding_malvious_repo/data/grocery_augmented/valid/labels.cache... 296 images, 77 backgrounds, 0 corrupt: 100% â”â”â”â”â”â”â”â”â”â”â”â” 296/296 12.5Mit/s 0.0s
[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 5% â•¸â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 1/19 2.7it/s 0.1s<6.6s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 11% â”â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 2/19 4.2it/s 0.2s<4.0s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 16% â”â•¸â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 3/19 4.8it/s 0.4s<3.4s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 21% â”â”â•¸â”€â”€â”€â”€â”€â”€â”€â”€â”€ 4/19 5.6it/s 0.5s<2.7s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 32% â”â”â”â•¸â”€â”€â”€â”€â”€â”€â”€â”€ 6/19 7.7it/s 0.7s<1.7s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 42% â”â”â”â”â”â”€â”€â”€â”€â”€â”€â”€ 8/19 9.2it/s 0.9s<1.2s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 53% â”â”â”â”â”â”â”€â”€â”€â”€â”€â”€ 10/19 9.9it/s 1.0s<0.9s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 63% â”â”â”â”â”â”â”â•¸â”€â”€â”€â”€ 12/19 10.8it/s 1.2s<0.6s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 74% â”â”â”â”â”â”â”â”â•¸â”€â”€â”€ 14/19 11.3it/s 1.3s<0.4s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 84% â”â”â”â”â”â”â”â”â”â”â”€â”€ 16/19 12.3it/s 1.5s<0.2s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 95% â”â”â”â”â”â”â”â”â”â”â”â”€ 18/19 12.1it/s 1.7s<0.1s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% â”â”â”â”â”â”â”â”â”â”â”â” 19/19 11.3it/s 1.7s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% â”â”â”â”â”â”â”â”â”â”â”â” 19/19 11.3it/s 1.7s
                   all        296        499      0.872      0.933      0.941      0.861
Speed: 0.8ms preprocess, 3.8ms inference, 0.0ms loss, 0.2ms postprocess per image
Results saved to [1m/home/currycareation/Desktop/yolo_embeding_malvious_repo/runs/detect/val57[0m

Results for YOLOv8_Baseline_488_Classes:
  mAP@0.5: 0.9414
  Precision: 0.8720
  Recall: 0.9327
  F1-Score: 0.9013
  Inference Time: 3.79 ms
  FPS: 263.64

================================================================================
Running Experiment: YOLOv11_Baseline_488_Classes
================================================================================

Evaluating YOLO baseline model...
Ultralytics 8.3.221 ðŸš€ Python-3.12.3 torch-2.9.0+cu128 CUDA:0 (NVIDIA GeForce RTX 5080, 15832MiB)
YOLO11m summary (fused): 125 layers, 20,075,521 parameters, 0 gradients, 67.9 GFLOPs
[34m[1mval: [0mFast image access âœ… (ping: 0.0Â±0.0 ms, read: 6123.9Â±1689.2 MB/s, size: 61.5 KB)
[K[34m[1mval: [0mScanning /home/currycareation/Desktop/yolo_embeding_malvious_repo/data/grocery_augmented/valid/labels.cache... 296 images, 77 backgrounds, 0 corrupt: 100% â”â”â”â”â”â”â”â”â”â”â”â” 296/296 137.9Mit/s 0.0s[K[34m[1mval: [0mScanning /home/currycareation/Desktop/yolo_embeding_malvious_repo/data/grocery_augmented/valid/labels.cache... 296 images, 77 backgrounds, 0 corrupt: 100% â”â”â”â”â”â”â”â”â”â”â”â” 296/296 12.5Mit/s 0.0s
[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 5% â•¸â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 1/19 1.4it/s 0.2s<12.8s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 11% â”â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 2/19 2.8it/s 0.4s<6.1s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 16% â”â•¸â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 3/19 4.0it/s 0.5s<4.0s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 21% â”â”â•¸â”€â”€â”€â”€â”€â”€â”€â”€â”€ 4/19 5.1it/s 0.7s<2.9s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 32% â”â”â”â•¸â”€â”€â”€â”€â”€â”€â”€â”€ 6/19 7.3it/s 0.8s<1.8s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 42% â”â”â”â”â”â”€â”€â”€â”€â”€â”€â”€ 8/19 8.9it/s 1.0s<1.2s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 47% â”â”â”â”â”â•¸â”€â”€â”€â”€â”€â”€ 9/19 9.1it/s 1.1s<1.1s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 58% â”â”â”â”â”â”â•¸â”€â”€â”€â”€â”€ 11/19 10.2it/s 1.2s<0.8s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 68% â”â”â”â”â”â”â”â”â”€â”€â”€â”€ 13/19 10.9it/s 1.4s<0.5s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 79% â”â”â”â”â”â”â”â”â”â”€â”€â”€ 15/19 11.7it/s 1.5s<0.3s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 89% â”â”â”â”â”â”â”â”â”â”â•¸â”€ 17/19 11.8it/s 1.7s<0.2s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% â”â”â”â”â”â”â”â”â”â”â”â” 19/19 10.4it/s 1.8s[K                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% â”â”â”â”â”â”â”â”â”â”â”â” 19/19 10.4it/s 1.8s
                   all        296        499      0.895      0.941      0.935      0.869
Speed: 0.9ms preprocess, 3.9ms inference, 0.0ms loss, 0.2ms postprocess per image
Results saved to [1m/home/currycareation/Desktop/yolo_embeding_malvious_repo/runs/detect/val58[0m
/home/currycareation/.local/lib/python3.12/site-packages/torch/backends/__init__.py:46: UserWarning: Please use the new API settings to control TF32 behavior, such as torch.backends.cudnn.conv.fp32_precision = 'tf32' or torch.backends.cuda.matmul.fp32_precision = 'ieee'. Old settings, e.g, torch.backends.cuda.matmul.allow_tf32 = True, torch.backends.cudnn.allow_tf32 = True, allowTF32CuDNN() and allowTF32CuBLAS() will be deprecated after Pytorch 2.9. Please see https://pytorch.org/docs/main/notes/cuda.html#tensorfloat-32-tf32-on-ampere-and-later-devices (Triggered internally at /pytorch/aten/src/ATen/Context.cpp:80.)
  self.setter(val)
/home/currycareation/.local/lib/python3.12/site-packages/milvus_lite/__init__.py:15: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import DistributionNotFound, get_distribution
/home/currycareation/Desktop/yolo_embeding_malvious_repo/yolo_vs_embeding_malvious/experimental_framework.py:331: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/currycareation/Desktop/yolo_embeding_malvious_repo/yolo_vs_embeding_malvious/experimental_framework.py:281: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/currycareation/Desktop/yolo_embeding_malvious_repo/yolo_vs_embeding_malvious/experimental_framework.py:331: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():

Results for YOLOv11_Baseline_488_Classes:
  mAP@0.5: 0.9352
  Precision: 0.8948
  Recall: 0.9413
  F1-Score: 0.9175
  Inference Time: 3.93 ms
  FPS: 254.19

================================================================================
Running Experiment: YOLOv8_DOLG_Milvus_Hybrid
================================================================================

ðŸ“¦ Using ImageNet pretrained DOLG embeddings
âœ… Loading DOLG weights from: dolg_retail_model/dolg_retail_best.pth
   ðŸ“¦ Loading retail-trained model (epoch 34, val_acc: 64.68%)
âœ… DOLG Extractor initialized on cuda:0
   Batch size: 32
   Mixed precision: True
âœ… Connected to Milvus database: experiment_results/milvus_retail_enhanced.db
ðŸ”¥ Warming up GPU for optimal performance...
âœ… GPU warmed up
âœ… Hybrid detector ready for production inference
Evaluating hybrid model...
âœ… Milvus connection closed

Results for YOLOv8_DOLG_Milvus_Hybrid:
  mAP@0.5: 0.0831
  Precision: 0.1716
  Recall: 0.1743
  F1-Score: 0.1730
  Inference Time: 5.36 ms
  FPS: 186.42
  Milvus Hit Rate: 100.00%

================================================================================
Running Experiment: YOLOv8_DOLG_Milvus_HighThreshold
================================================================================

ðŸ“¦ Using ImageNet pretrained DOLG embeddings
âœ… Loading DOLG weights from: dolg_retail_model/dolg_retail_best.pth
   ðŸ“¦ Loading retail-trained model (epoch 34, val_acc: 64.68%)
âœ… DOLG Extractor initialized on cuda:0
   Batch size: 32
   Mixed precision: True
âœ… Connected to Milvus database: experiment_results/milvus_retail_enhanced.db
ðŸ”¥ Warming up GPU for optimal performance...
âœ… GPU warmed up
âœ… Hybrid detector ready for production inference
Evaluating hybrid model...
âœ… Milvus connection closed

Results for YOLOv8_DOLG_Milvus_HighThreshold:
  mAP@0.5: 0.1054
  Precision: 0.1815
  Recall: 0.1844
  F1-Score: 0.1829
  Inference Time: 5.32 ms
  FPS: 188.07
  Milvus Hit Rate: 58.19%

====================================================================================================
EXPERIMENT COMPARISON REPORT
====================================================================================================

Experiment                                  mAP@0.5  Precision     Recall         F1        FPS     Milvus
----------------------------------------------------------------------------------------------------
YOLOv8_Baseline_488_Classes                  0.9414     0.8720     0.9327     0.9013     263.64        N/A
YOLOv11_Baseline_488_Classes                 0.9352     0.8948     0.9413     0.9175     254.19        N/A
YOLOv8_DOLG_Milvus_Hybrid                    0.0831     0.1716     0.1743     0.1730     186.42      100.0
YOLOv8_DOLG_Milvus_HighThreshold             0.1054     0.1815     0.1844     0.1829     188.07       58.2

====================================================================================================

Comparison report saved to: experiment_comparison.json

âœ… All experiments completed successfully!
ðŸ“Š View results in MLflow UI: mlflow ui --backend-store-uri file:./mlruns

################################################################################
# RETAIL ITEM DETECTION - COMPLETE EXPERIMENTAL PIPELINE
################################################################################


â­ï¸  Skipping YOLOv8 training (train_yolov8: false)
âœ… Using pretrained YOLOv8 model: grocery/runs/yolov8_grocery_baseline_20251114_194239/weights/best.pt

â­ï¸  Skipping YOLOv11 training (train_yolov11: false)
âœ… Using pretrained YOLOv11 model: grocery/runs/yolo11_grocery_baseline_20251114_1953262/weights/best.pt

ðŸ“‹ Model Summary:
   YOLOv8: grocery/runs/yolov8_grocery_baseline_20251114_194239/weights/best.pt
   YOLOv11: grocery/runs/yolo11_grocery_baseline_20251114_1953262/weights/best.pt


================================================================================
Populating Milvus Database with DOLG Embeddings
================================================================================


âœ… Milvus database populated: experiment_results/milvus_retail_enhanced.db

================================================================================
Running Comparative Experiments
================================================================================


================================================================================
Generating Visualization Reports
================================================================================

âœ… Saved: experiment_results/visualizations/detection_performance.png
âœ… Saved: experiment_results/visualizations/speed_performance.png
âœ… Saved: experiment_results/visualizations/milvus_analysis.png
âœ… Saved: experiment_results/visualizations/summary_table.png
âœ… Saved: experiment_results/visualizations/results_summary.csv

ðŸ“Š All visualizations saved to: experiment_results/visualizations

================================================================================
Generating Comprehensive Report
================================================================================

âœ… Report saved to: experiment_results/EXPERIMENT_REPORT.md

################################################################################
# PIPELINE COMPLETE!
################################################################################

ðŸ“ Results directory: experiment_results
ðŸ“Š View MLflow UI: mlflow ui --backend-store-uri file:./mlruns
