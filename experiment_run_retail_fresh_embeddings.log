
ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€
PRODUCTION-GRADE MILVUS POPULATION PIPELINE
ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€

ğŸ® GPU Device: NVIDIA GeForce RTX 5080
ğŸ’¾ GPU Memory: 15.46 GB

ğŸ”¬ Initializing Production DOLG Embedding Extractor...
âœ… Loading DOLG weights from: dolg_retail_model/dolg_retail_best.pth
Traceback (most recent call last):
  File "/home/currycareation/Desktop/yolo_embeding_malvious_repo/yolo_vs_embeding_malvious/populate_milvus_embeddings.py", line 885, in <module>
    main()
  File "/home/currycareation/Desktop/yolo_embeding_malvious_repo/yolo_vs_embeding_malvious/populate_milvus_embeddings.py", line 865, in main
    populate_milvus_from_dataset(
  File "/home/currycareation/Desktop/yolo_embeding_malvious_repo/yolo_vs_embeding_malvious/populate_milvus_embeddings.py", line 714, in populate_milvus_from_dataset
    embedding_extractor = DOLGEmbeddingExtractor(
                          ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/currycareation/Desktop/yolo_embeding_malvious_repo/yolo_vs_embeding_malvious/populate_milvus_embeddings.py", line 64, in __init__
    self.model = self._load_dolg_model(model_path)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/currycareation/Desktop/yolo_embeding_malvious_repo/yolo_vs_embeding_malvious/populate_milvus_embeddings.py", line 123, in _load_dolg_model
    model.load_state_dict(state_dict)
  File "/home/currycareation/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 2629, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for ProductionDOLGModel:
	Missing key(s) in state_dict: "backbone.features.0.0.weight", "backbone.features.0.1.weight", "backbone.features.0.1.bias", "backbone.features.0.1.running_mean", "backbone.features.0.1.running_var", "backbone.features.1.0.block.0.0.weight", "backbone.features.1.0.block.0.1.weight", "backbone.features.1.0.block.0.1.bias", "backbone.features.1.0.block.0.1.running_mean", "backbone.features.1.0.block.0.1.running_var", "backbone.features.1.0.block.1.fc1.weight", "backbone.features.1.0.block.1.fc1.bias", "backbone.features.1.0.block.1.fc2.weight", "backbone.features.1.0.block.1.fc2.bias", "backbone.features.1.0.block.2.0.weight", "backbone.features.1.0.block.2.1.weight", "backbone.features.1.0.block.2.1.bias", "backbone.features.1.0.block.2.1.running_mean", "backbone.features.1.0.block.2.1.running_var", "backbone.features.2.0.block.0.0.weight", "backbone.features.2.0.block.0.1.weight", "backbone.features.2.0.block.0.1.bias", "backbone.features.2.0.block.0.1.running_mean", "backbone.features.2.0.block.0.1.running_var", "backbone.features.2.0.block.1.0.weight", "backbone.features.2.0.block.1.1.weight", "backbone.features.2.0.block.1.1.bias", "backbone.features.2.0.block.1.1.running_mean", "backbone.features.2.0.block.1.1.running_var", "backbone.features.2.0.block.2.fc1.weight", "backbone.features.2.0.block.2.fc1.bias", "backbone.features.2.0.block.2.fc2.weight", "backbone.features.2.0.block.2.fc2.bias", "backbone.features.2.0.block.3.0.weight", "backbone.features.2.0.block.3.1.weight", "backbone.features.2.0.block.3.1.bias", "backbone.features.2.0.block.3.1.running_mean", "backbone.features.2.0.block.3.1.running_var", "backbone.features.2.1.block.0.0.weight", "backbone.features.2.1.block.0.1.weight", "backbone.features.2.1.block.0.1.bias", "backbone.features.2.1.block.0.1.running_mean", "backbone.features.2.1.block.0.1.running_var", "backbone.features.2.1.block.1.0.weight", "backbone.features.2.1.block.1.1.weight", "backbone.features.2.1.block.1.1.bias", "backbone.features.2.1.block.1.1.running_mean", "backbone.features.2.1.block.1.1.running_var", "backbone.features.2.1.block.2.fc1.weight", "backbone.features.2.1.block.2.fc1.bias", "backbone.features.2.1.block.2.fc2.weight", "backbone.features.2.1.block.2.fc2.bias", "backbone.features.2.1.block.3.0.weight", "backbone.features.2.1.block.3.1.weight", "backbone.features.2.1.block.3.1.bias", "backbone.features.2.1.block.3.1.running_mean", "backbone.features.2.1.block.3.1.running_var", "backbone.features.3.0.block.0.0.weight", "backbone.features.3.0.block.0.1.weight", "backbone.features.3.0.block.0.1.bias", "backbone.features.3.0.block.0.1.running_mean", "backbone.features.3.0.block.0.1.running_var", "backbone.features.3.0.block.1.0.weight", "backbone.features.3.0.block.1.1.weight", "backbone.features.3.0.block.1.1.bias", "backbone.features.3.0.block.1.1.running_mean", "backbone.features.3.0.block.1.1.running_var", "backbone.features.3.0.block.2.fc1.weight", "backbone.features.3.0.block.2.fc1.bias", "backbone.features.3.0.block.2.fc2.weight", "backbone.features.3.0.block.2.fc2.bias", "backbone.features.3.0.block.3.0.weight", "backbone.features.3.0.block.3.1.weight", "backbone.features.3.0.block.3.1.bias", "backbone.features.3.0.block.3.1.running_mean", "backbone.features.3.0.block.3.1.running_var", "backbone.features.3.1.block.0.0.weight", "backbone.features.3.1.block.0.1.weight", "backbone.features.3.1.block.0.1.bias", "backbone.features.3.1.block.0.1.running_mean", "backbone.features.3.1.block.0.1.running_var", "backbone.features.3.1.block.1.0.weight", "backbone.features.3.1.block.1.1.weight", "backbone.features.3.1.block.1.1.bias", "backbone.features.3.1.block.1.1.running_mean", "backbone.features.3.1.block.1.1.running_var", "backbone.features.3.1.block.2.fc1.weight", "backbone.features.3.1.block.2.fc1.bias", "backbone.features.3.1.block.2.fc2.weight", "backbone.features.3.1.block.2.fc2.bias", "backbone.features.3.1.block.3.0.weight", "backbone.features.3.1.block.3.1.weight", "backbone.features.3.1.block.3.1.bias", "backbone.features.3.1.block.3.1.running_mean", "backbone.features.3.1.block.3.1.running_var", "backbone.features.4.0.block.0.0.weight", "backbone.features.4.0.block.0.1.weight", "backbone.features.4.0.block.0.1.bias", "backbone.features.4.0.block.0.1.running_mean", "backbone.features.4.0.block.0.1.running_var", "backbone.features.4.0.block.1.0.weight", "backbone.features.4.0.block.1.1.weight", "backbone.features.4.0.block.1.1.bias", "backbone.features.4.0.block.1.1.running_mean", "backbone.features.4.0.block.1.1.running_var", "backbone.features.4.0.block.2.fc1.weight", "backbone.features.4.0.block.2.fc1.bias", "backbone.features.4.0.block.2.fc2.weight", "backbone.features.4.0.block.2.fc2.bias", "backbone.features.4.0.block.3.0.weight", "backbone.features.4.0.block.3.1.weight", "backbone.features.4.0.block.3.1.bias", "backbone.features.4.0.block.3.1.running_mean", "backbone.features.4.0.block.3.1.running_var", "backbone.features.4.1.block.0.0.weight", "backbone.features.4.1.block.0.1.weight", "backbone.features.4.1.block.0.1.bias", "backbone.features.4.1.block.0.1.running_mean", "backbone.features.4.1.block.0.1.running_var", "backbone.features.4.1.block.1.0.weight", "backbone.features.4.1.block.1.1.weight", "backbone.features.4.1.block.1.1.bias", "backbone.features.4.1.block.1.1.running_mean", "backbone.features.4.1.block.1.1.running_var", "backbone.features.4.1.block.2.fc1.weight", "backbone.features.4.1.block.2.fc1.bias", "backbone.features.4.1.block.2.fc2.weight", "backbone.features.4.1.block.2.fc2.bias", "backbone.features.4.1.block.3.0.weight", "backbone.features.4.1.block.3.1.weight", "backbone.features.4.1.block.3.1.bias", "backbone.features.4.1.block.3.1.running_mean", "backbone.features.4.1.block.3.1.running_var", "backbone.features.4.2.block.0.0.weight", "backbone.features.4.2.block.0.1.weight", "backbone.features.4.2.block.0.1.bias", "backbone.features.4.2.block.0.1.running_mean", "backbone.features.4.2.block.0.1.running_var", "backbone.features.4.2.block.1.0.weight", "backbone.features.4.2.block.1.1.weight", "backbone.features.4.2.block.1.1.bias", "backbone.features.4.2.block.1.1.running_mean", "backbone.features.4.2.block.1.1.running_var", "backbone.features.4.2.block.2.fc1.weight", "backbone.features.4.2.block.2.fc1.bias", "backbone.features.4.2.block.2.fc2.weight", "backbone.features.4.2.block.2.fc2.bias", "backbone.features.4.2.block.3.0.weight", "backbone.features.4.2.block.3.1.weight", "backbone.features.4.2.block.3.1.bias", "backbone.features.4.2.block.3.1.running_mean", "backbone.features.4.2.block.3.1.running_var", "backbone.features.5.0.block.0.0.weight", "backbone.features.5.0.block.0.1.weight", "backbone.features.5.0.block.0.1.bias", "backbone.features.5.0.block.0.1.running_mean", "backbone.features.5.0.block.0.1.running_var", "backbone.features.5.0.block.1.0.weight", "backbone.features.5.0.block.1.1.weight", "backbone.features.5.0.block.1.1.bias", "backbone.features.5.0.block.1.1.running_mean", "backbone.features.5.0.block.1.1.running_var", "backbone.features.5.0.block.2.fc1.weight", "backbone.features.5.0.block.2.fc1.bias", "backbone.features.5.0.block.2.fc2.weight", "backbone.features.5.0.block.2.fc2.bias", "backbone.features.5.0.block.3.0.weight", "backbone.features.5.0.block.3.1.weight", "backbone.features.5.0.block.3.1.bias", "backbone.features.5.0.block.3.1.running_mean", "backbone.features.5.0.block.3.1.running_var", "backbone.features.5.1.block.0.0.weight", "backbone.features.5.1.block.0.1.weight", "backbone.features.5.1.block.0.1.bias", "backbone.features.5.1.block.0.1.running_mean", "backbone.features.5.1.block.0.1.running_var", "backbone.features.5.1.block.1.0.weight", "backbone.features.5.1.block.1.1.weight", "backbone.features.5.1.block.1.1.bias", "backbone.features.5.1.block.1.1.running_mean", "backbone.features.5.1.block.1.1.running_var", "backbone.features.5.1.block.2.fc1.weight", "backbone.features.5.1.block.2.fc1.bias", "backbone.features.5.1.block.2.fc2.weight", "backbone.features.5.1.block.2.fc2.bias", "backbone.features.5.1.block.3.0.weight", "backbone.features.5.1.block.3.1.weight", "backbone.features.5.1.block.3.1.bias", "backbone.features.5.1.block.3.1.running_mean", "backbone.features.5.1.block.3.1.running_var", "backbone.features.5.2.block.0.0.weight", "backbone.features.5.2.block.0.1.weight", "backbone.features.5.2.block.0.1.bias", "backbone.features.5.2.block.0.1.running_mean", "backbone.features.5.2.block.0.1.running_var", "backbone.features.5.2.block.1.0.weight", "backbone.features.5.2.block.1.1.weight", "backbone.features.5.2.block.1.1.bias", "backbone.features.5.2.block.1.1.running_mean", "backbone.features.5.2.block.1.1.running_var", "backbone.features.5.2.block.2.fc1.weight", "backbone.features.5.2.block.2.fc1.bias", "backbone.features.5.2.block.2.fc2.weight", "backbone.features.5.2.block.2.fc2.bias", "backbone.features.5.2.block.3.0.weight", "backbone.features.5.2.block.3.1.weight", "backbone.features.5.2.block.3.1.bias", "backbone.features.5.2.block.3.1.running_mean", "backbone.features.5.2.block.3.1.running_var", "backbone.features.6.0.block.0.0.weight", "backbone.features.6.0.block.0.1.weight", "backbone.features.6.0.block.0.1.bias", "backbone.features.6.0.block.0.1.running_mean", "backbone.features.6.0.block.0.1.running_var", "backbone.features.6.0.block.1.0.weight", "backbone.features.6.0.block.1.1.weight", "backbone.features.6.0.block.1.1.bias", "backbone.features.6.0.block.1.1.running_mean", "backbone.features.6.0.block.1.1.running_var", "backbone.features.6.0.block.2.fc1.weight", "backbone.features.6.0.block.2.fc1.bias", "backbone.features.6.0.block.2.fc2.weight", "backbone.features.6.0.block.2.fc2.bias", "backbone.features.6.0.block.3.0.weight", "backbone.features.6.0.block.3.1.weight", "backbone.features.6.0.block.3.1.bias", "backbone.features.6.0.block.3.1.running_mean", "backbone.features.6.0.block.3.1.running_var", "backbone.features.6.1.block.0.0.weight", "backbone.features.6.1.block.0.1.weight", "backbone.features.6.1.block.0.1.bias", "backbone.features.6.1.block.0.1.running_mean", "backbone.features.6.1.block.0.1.running_var", "backbone.features.6.1.block.1.0.weight", "backbone.features.6.1.block.1.1.weight", "backbone.features.6.1.block.1.1.bias", "backbone.features.6.1.block.1.1.running_mean", "backbone.features.6.1.block.1.1.running_var", "backbone.features.6.1.block.2.fc1.weight", "backbone.features.6.1.block.2.fc1.bias", "backbone.features.6.1.block.2.fc2.weight", "backbone.features.6.1.block.2.fc2.bias", "backbone.features.6.1.block.3.0.weight", "backbone.features.6.1.block.3.1.weight", "backbone.features.6.1.block.3.1.bias", "backbone.features.6.1.block.3.1.running_mean", "backbone.features.6.1.block.3.1.running_var", "backbone.features.6.2.block.0.0.weight", "backbone.features.6.2.block.0.1.weight", "backbone.features.6.2.block.0.1.bias", "backbone.features.6.2.block.0.1.running_mean", "backbone.features.6.2.block.0.1.running_var", "backbone.features.6.2.block.1.0.weight", "backbone.features.6.2.block.1.1.weight", "backbone.features.6.2.block.1.1.bias", "backbone.features.6.2.block.1.1.running_mean", "backbone.features.6.2.block.1.1.running_var", "backbone.features.6.2.block.2.fc1.weight", "backbone.features.6.2.block.2.fc1.bias", "backbone.features.6.2.block.2.fc2.weight", "backbone.features.6.2.block.2.fc2.bias", "backbone.features.6.2.block.3.0.weight", "backbone.features.6.2.block.3.1.weight", "backbone.features.6.2.block.3.1.bias", "backbone.features.6.2.block.3.1.running_mean", "backbone.features.6.2.block.3.1.running_var", "backbone.features.6.3.block.0.0.weight", "backbone.features.6.3.block.0.1.weight", "backbone.features.6.3.block.0.1.bias", "backbone.features.6.3.block.0.1.running_mean", "backbone.features.6.3.block.0.1.running_var", "backbone.features.6.3.block.1.0.weight", "backbone.features.6.3.block.1.1.weight", "backbone.features.6.3.block.1.1.bias", "backbone.features.6.3.block.1.1.running_mean", "backbone.features.6.3.block.1.1.running_var", "backbone.features.6.3.block.2.fc1.weight", "backbone.features.6.3.block.2.fc1.bias", "backbone.features.6.3.block.2.fc2.weight", "backbone.features.6.3.block.2.fc2.bias", "backbone.features.6.3.block.3.0.weight", "backbone.features.6.3.block.3.1.weight", "backbone.features.6.3.block.3.1.bias", "backbone.features.6.3.block.3.1.running_mean", "backbone.features.6.3.block.3.1.running_var", "backbone.features.7.0.block.0.0.weight", "backbone.features.7.0.block.0.1.weight", "backbone.features.7.0.block.0.1.bias", "backbone.features.7.0.block.0.1.running_mean", "backbone.features.7.0.block.0.1.running_var", "backbone.features.7.0.block.1.0.weight", "backbone.features.7.0.block.1.1.weight", "backbone.features.7.0.block.1.1.bias", "backbone.features.7.0.block.1.1.running_mean", "backbone.features.7.0.block.1.1.running_var", "backbone.features.7.0.block.2.fc1.weight", "backbone.features.7.0.block.2.fc1.bias", "backbone.features.7.0.block.2.fc2.weight", "backbone.features.7.0.block.2.fc2.bias", "backbone.features.7.0.block.3.0.weight", "backbone.features.7.0.block.3.1.weight", "backbone.features.7.0.block.3.1.bias", "backbone.features.7.0.block.3.1.running_mean", "backbone.features.7.0.block.3.1.running_var", "backbone.features.8.0.weight", "backbone.features.8.1.weight", "backbone.features.8.1.bias", "backbone.features.8.1.running_mean", "backbone.features.8.1.running_var", "backbone.classifier.1.weight", "backbone.classifier.1.bias", "backbone.classifier.2.weight", "backbone.classifier.2.bias", "backbone.classifier.2.running_mean", "backbone.classifier.2.running_var", "backbone.classifier.5.weight", "backbone.classifier.5.bias". 
	Unexpected key(s) in state_dict: "epoch", "model_state_dict", "optimizer_state_dict", "val_acc", "embedding_dim", "num_classes". 

################################################################################
# RETAIL ITEM DETECTION - COMPLETE EXPERIMENTAL PIPELINE
################################################################################


â­ï¸  Skipping YOLOv8 training (train_yolov8: false)

â­ï¸  Skipping YOLOv11 training (train_yolov11: false)

ğŸ“‹ Model Summary:
   YOLOv8: scripts/yolov8m.pt
   YOLOv11: scripts/yolo11m.pt


================================================================================
Populating Milvus Database with DOLG Embeddings
================================================================================

Traceback (most recent call last):
  File "/home/currycareation/Desktop/yolo_embeding_malvious_repo/yolo_vs_embeding_malvious/run_experiments.py", line 641, in <module>
    main()
  File "/home/currycareation/Desktop/yolo_embeding_malvious_repo/yolo_vs_embeding_malvious/run_experiments.py", line 597, in main
    orchestrator.run_complete_pipeline()
  File "/home/currycareation/Desktop/yolo_embeding_malvious_repo/yolo_vs_embeding_malvious/run_experiments.py", line 559, in run_complete_pipeline
    milvus_db = self.populate_milvus()
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/currycareation/Desktop/yolo_embeding_malvious_repo/yolo_vs_embeding_malvious/run_experiments.py", line 176, in populate_milvus
    subprocess.run(cmd, check=True)
  File "/usr/lib/python3.12/subprocess.py", line 571, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/currycareation/Desktop/yolo_embeding_malvious_repo/yolo_vs_embeding_malvious/populate_milvus_embeddings.py', '--dataset', 'data/grocery_augmented/grocery_augmented.yaml', '--dolg-model', 'dolg_retail_model/dolg_retail_best.pth', '--milvus-db', 'experiment_results/milvus_retail_enhanced.db', '--collection', 'retail_items', '--max-templates', '10', '--cache', 'experiment_results/embedding_cache.pkl', '--device', 'cuda:0']' returned non-zero exit status 1.
